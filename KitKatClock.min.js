/*
=================================================
KitKatClock jQuery Plugin

Author: Bryan Iddings
http://iddings.co/KitKatClock

****MAINTAIN THIS HEADER WHEN REDISTRIBUTING****

This work is licensed under the Creative
Commons Attribution-NonCommercial-ShareAlike
4.0 International License. To view a copy of
this license, visit
http://creativecommons.org/licenses/by-nc-sa/4.0/
=================================================
*/
(function(e){e.fn.kitkatclock=function(p){return this.each(function(){function M(b){if(null==b)return null;b=b.replace("#","").replace(/grey/i,"gray");if(-1!=b.indexOf("rgb")){if(-1!=b.indexOf("rgba"))return b;rgb=b.split("(")[1].split(")")[0];return"rgba("+rgb+",1)"}if(I[b.toLowerCase()])return I[b.toLowerCase()];if(3==b.length){var a=b.substring(0,1),c=b.substring(1,2);b=b.substring(2,3);a+=a;c+=c;b+=b}else a=b.substring(0,2),c=b.substring(2,4),b=b.substring(4,6);return"rgba("+parseInt(a,16)+","+parseInt(c,
16)+","+parseInt(b,16)+",1)"}function N(b,a){a=a.replace(/rgba|\(|\)/g,"");b=b.replace(/rgba|\(|\)/g,"");a=a.split(",");b=b.split(",");return"rgba("+Math.round(.4*parseInt(a[0])+.6*parseInt(b[0]))+","+Math.round(.4*parseInt(a[1])+.6*parseInt(b[1]))+","+Math.round(.4*parseInt(a[2])+.6*parseInt(b[2]))+",1)"}function x(b,a){var c=b.getContext("2d");c.fillStyle=a;c.clearRect(0,0,2*d,2*d);c.arc(d/2,d/2,d/2,0,2*h);c.fill()}function J(){u.val(q.html().replace("&nbsp;","")+":"+n.html()+" "+(s[0].checked?
"AM":"PM"));k.hide()}function F(){q.css("color",a.g);n.css("color","");var b=y[0].getContext("2d");b.clearRect(0,0,f,f);b.fillStyle=a.e;b.font=d+"px "+z;b.textBaseline="middle";b.textAlign="center";for(var l=Math.PI,c=l/2,e=0;12>e;e++)b.fillText(0==e?12:e,g+-1*Math.cos(c)*(g-d/1.75),g+-1*Math.sin(c)*(g-d/1.75)),c+=l/6;void 0!=k.attr("hour")?(b=parseInt(k.attr("hour")),A(l/2+l/6*b)):A(l/2)}function K(){n.css("color",a.g);q.css("color","");var b=y[0].getContext("2d");b.clearRect(0,0,f,f);b.fillStyle=
a.e;b.font=d+"px "+z;b.textBaseline="middle";b.textAlign="center";for(var l=h/2,c=0;12>c;c++)b.fillText(5*c,g+-1*Math.cos(l)*(g-d/1.5),g+-1*Math.sin(l)*(g-d/1.5)),l+=h/6;void 0!=k.attr("minute")?(b=parseInt(k.attr("minute")),A(h/2+h/30*b)):A(h/2)}function A(b){B.css({"-webkit-transform":"rotate("+180*b/h+"deg)"})}function O(){var b=B[0].getContext("2d");b.clearRect(0,0,f,f);var l=g+-1*Math.cos(0)*(g-d/1.5),c=g+-1*Math.sin(0)*(g-d/1.5);b.beginPath();b.moveTo(g,g);b.lineTo(l,c);b.strokeStyle=a.a;b.lineWidth=
8;b.stroke();b.closePath();b.arc(l,c,.675*d,0,2*h);b.fillStyle=a.a;b.fill()}function P(b,a,c){b-=g;a-=g;c/=2;a=h/c*Math.round(Math.asin(a/Math.sqrt(b*b+a*a))/(h/c));a/=h;a*=c;c/=2;0<b||(c*=3,a*=-1);return c+a}var I={aliceblue:"rgba(240,248,255,1)",antiquewhite:"rgba(250,235,215,1)",aqua:"rgba(0,255,255,1)",aquamarine:"rgba(127,255,212,1)",azure:"rgba(240,255,255,1)",beige:"rgba(245,245,220,1)",bisque:"rgba(255,228,196,1)",black:"rgba(0,0,0,1)",blanchedalmond:"rgba(255,235,205,1)",blue:"rgba(0,0,255,1)",
blueviolet:"rgba(138,43,226,1)",brown:"rgba(165,42,42,1)",burlywood:"rgba(222,184,135,1)",cadetblue:"rgba(95,158,160,1)",chartreuse:"rgba(127,255,0,1)",chocolate:"rgba(210,105,30,1)",coral:"rgba(255,127,80,1)",cornflowerblue:"rgba(100,149,237,1)",cornsilk:"rgba(255,248,220,1)",crimson:"rgba(220,20,60,1)",cyan:"rgba(0,255,255,1)",darkblue:"rgba(0,0,139,1)",darkcyan:"rgba(0,139,139,1)",darkgoldenrod:"rgba(184,134,11,1)",darkgray:"rgba(169,169,169,1)",darkgreen:"rgba(0,100,0,1)",darkkhaki:"rgba(189,183,107,1)",
darkmagenta:"rgba(139,0,139,1)",darkolivegreen:"rgba(85,107,47,1)",darkorange:"rgba(255,140,0,1)",darkorchid:"rgba(153,50,204,1)",darkred:"rgba(139,0,0,1)",darksalmon:"rgba(233,150,122,1)",darkseagreen:"rgba(143,188,143,1)",darkslateblue:"rgba(72,61,139,1)",darkslategray:"rgba(47,79,79,1)",darkturquoise:"rgba(0,206,209,1)",darkviolet:"rgba(148,0,211,1)",deeppink:"rgba(255,20,147,1)",deepskyblue:"rgba(0,191,255,1)",dimgray:"rgba(105,105,105,1)",dodgerblue:"rgba(30,144,255,1)",firebrick:"rgba(178,34,34,1)",
floralwhite:"rgba(255,250,240,1)",forestgreen:"rgba(34,139,34,1)",fuchsia:"rgba(255,0,255,1)",gainsboro:"rgba(220,220,220,1)",ghostwhite:"rgba(248,248,255,1)",gold:"rgba(255,215,0,1)",goldenrod:"rgba(218,165,32,1)",gray:"rgba(128,128,128,1)",green:"rgba(0,128,0,1)",greenyellow:"rgba(173,255,47,1)",honeydew:"rgba(240,255,240,1)",hotpink:"rgba(255,105,180,1)",indianred:"rgba(205,92,92,1)",indigo:"rgba(75,0,130,1)",ivory:"rgba(255,255,240,1)",khaki:"rgba(240,230,140,1)",lavender:"rgba(230,230,250,1)",
lavenderblush:"rgba(255,240,245,1)",lawngreen:"rgba(124,252,0,1)",lemonchiffon:"rgba(255,250,205,1)",lightblue:"rgba(173,216,230,1)",lightcoral:"rgba(240,128,128,1)",lightcyan:"rgba(224,255,255,1)",lightgoldenrodyellow:"rgba(250,250,210,1)",lightgray:"rgba(211,211,211,1)",lightgreen:"rgba(144,238,144,1)",lightpink:"rgba(255,182,193,1)",lightsalmon:"rgba(255,160,122,1)",lightseagreen:"rgba(32,178,170,1)",lightskyblue:"rgba(135,206,250,1)",lightslategray:"rgba(119,136,153,1)",lightsteelblue:"rgba(176,196,222,1)",
lightyellow:"rgba(255,255,224,1)",lime:"rgba(0,255,0,1)",limegreen:"rgba(50,205,50,1)",linen:"rgba(250,240,230,1)",magenta:"rgba(255,0,255,1)",maroon:"rgba(128,0,0,1)",mediumaquamarine:"rgba(102,205,170,1)",mediumblue:"rgba(0,0,205,1)",mediumorchid:"rgba(186,85,211,1)",mediumpurple:"rgba(147,112,219,1)",mediumseagreen:"rgba(60,179,113,1)",mediumslateblue:"rgba(123,104,238,1)",mediumspringgreen:"rgba(0,250,154,1)",mediumturquoise:"rgba(72,209,204,1)",mediumvioletred:"rgba(199,21,133,1)",midnightblue:"rgba(25,25,112,1)",
mintcream:"rgba(245,255,250,1)",mistyrose:"rgba(255,228,225,1)",moccasin:"rgba(255,228,181,1)",navajowhite:"rgba(255,222,173,1)",navy:"rgba(0,0,128,1)",oldlace:"rgba(253,245,230,1)",olive:"rgba(128,128,0,1)",olivedrab:"rgba(107,142,35,1)",orange:"rgba(255,165,0,1)",orangered:"rgba(255,69,0,1)",orchid:"rgba(218,112,214,1)",palegoldenrod:"rgba(238,232,170,1)",palegreen:"rgba(152,251,152,1)",paleturquoise:"rgba(175,238,238,1)",palevioletred:"rgba(219,112,147,1)",papayawhip:"rgba(255,239,213,1)",peachpuff:"rgba(255,218,185,1)",
peru:"rgba(205,133,63,1)",pink:"rgba(255,192,203,1)",plum:"rgba(221,160,221,1)",powderblue:"rgba(176,224,230,1)",purple:"rgba(128,0,128,1)",red:"rgba(255,0,0,1)",rosybrown:"rgba(188,143,143,1)",royalblue:"rgba(65,105,225,1)",saddlebrown:"rgba(139,69,19,1)",salmon:"rgba(250,128,114,1)",sandybrown:"rgba(244,164,96,1)",seagreen:"rgba(46,139,87,1)",seashell:"rgba(255,245,238,1)",sienna:"rgba(160,82,45,1)",silver:"rgba(192,192,192,1)",skyblue:"rgba(135,206,235,1)",slateblue:"rgba(106,90,205,1)",slategray:"rgba(112,128,144,1)",
snow:"rgba(255,250,250,1)",springgreen:"rgba(0,255,127,1)",steelblue:"rgba(70,130,180,1)",tan:"rgba(210,180,140,1)",teal:"rgba(0,128,128,1)",thistle:"rgba(216,191,216,1)",tomato:"rgba(255,99,71,1)",turquoise:"rgba(64,224,208,1)",violet:"rgba(238,130,238,1)",wheat:"rgba(245,222,179,1)",white:"rgba(255,255,255,1)",whitesmoke:"rgba(245,245,245,1)",yellow:"rgba(255,255,0,1)",yellowgreen:"rgba(154,205,50,1)"};p=p||{};var f=p.size||350;"number"!==typeof f&&(f=f.indexOf("pt")?4/3*parseFloat(f):parseFloat(f));
var f=f-26,d=p.fontSize||40;"number"!==typeof d&&(d=d.indexOf("pt")?4/3*parseFloat(d):parseFloat(d));var z=p.fontFamily||"Verdana, sans-serif",a=p.colors||{};a.text=a.text||"#FFFFFF";a.d=a.clock||"#050505";a.e=a.numerals||a.text;a.a=a.hand||"#960000";a.background=a.background||"#222222";a.c=a.meridian_background_on||a.a;a.b=a.meridian_background_off||null;a.i=a.meridian_text||a.text;a.g=a.top_indicator_selected||a.a;a.f=a.top_indicator_deselected||a.text;a.h=a.top_indicator_background||a.d;a.border=a.border||"#CCCCCC";for(var L in a)a[L]=M(a[L]);a.b||(a.b=N(a.c,a.background));var g=f/2,h=Math.PI,G=!1,t=!0,H=!0,D,B,y,q,n,C,m,v,s,w,k=e("<div>").hide(),
u=e(this).on("mouseup",function(){if(e(this).is(":focus")){e(this).trigger("blur");var b=u.val().split(":"),a=parseInt(b[0]),b=parseInt(b[1]);k.attr({k:12==a?0:a,m:b});q.html((10>a?"&nbsp;":"")+a);n.html((10>b?"0":"")+b);t=!0;F();k.show();for(var c=u.offset(),a=e(window).width(),b=e(window).height(),d=e(document).width(),f=e(document).height(),g=k.outerWidth(),E=k.outerHeight(),r=c.top,c=c.left,h=e("body").scrollTop(),m=e("body").scrollLeft(),s=h+b,p=m+a;r+E>f&&0<r;)r-=1;for(;c+g>d&&0<c;)c-=1;if(g<=
a){for(;c<m;)c++;for(;c+g>p;)c--}else c=m-(g-a)/2;if(E<=b){for(;r<h;)r++;for(;r+E>s;)r--}else r=h-(E-b)/2;k.css({position:"absolute",top:r,left:c});a=q.html();q.html("12");b=n.height()+n.position().top-w.height()-5;d=n.width()+n.position().left;w.css({position:"absolute",top:b,left:d});q.html(a);e("body").on("click",function(a){a=a.target;e(a).is(k)||0!=k.has(a).length||e(a).is(u)||J()});e("*",k).css("textShadow","none")}});(function(){e("body").append(k);""==u.val()&&u.val("12:00 AM");D=e("<canvas>");
B=e("<canvas>");y=e("<canvas>");s=e("<input type='checkbox'>").on("change",function(){this.checked?(x(m[0],a.c),x(v[0],a.b),w.html("AM")):(x(v[0],a.c),x(m[0],a.b),w.html("PM"))}).hide();m=e("<canvas>");v=e("<canvas>");var b=e("<div>AM</div>").css({position:"absolute",top:10+f,left:10,width:d,height:d,textAlign:"center",lineHeight:d+"px",fontSize:d/2,fontFamily:z,cursor:"pointer"}).on("click",function(){m.trigger("click")}),l=e("<div>PM</div>").css({position:"absolute",top:10+f,right:10,width:d,height:d,
textAlign:"center",lineHeight:d+"px",fontSize:d/2,fontFamily:z,cursor:"pointer"}).on("click",function(){v.trigger("click")});w=e("<div>").css({color:a.f,display:"inline-block"});e([m,v]).each(function(){this.attr({height:d,width:d}).on("click",function(){s[0].checked=e(this).is(m);s.trigger("change")}).css({position:"absolute",top:f+10});this==m?this.css("left",10):this.css("right",10);x(this[0],a.c)});-1!=u.val().toUpperCase().indexOf("AM")&&(s[0].checked=!0);s.trigger("change");k.css({width:f,height:f+
2*d+10,zIndex:9999999,backgroundColor:a.background,borderRadius:"3px",padding:"3px 10px",border:"3px solid "+a.border,fontFamily:z,color:a.text});C=e("<div>").css({position:"absolute",top:d+10,left:10,width:f,height:f,cursor:"hand"});e([D,B,y]).each(function(){this.attr({width:f,height:f}).css({position:"absolute",top:"3px",left:"0px"})});q=e("<span>").html(12).on("click",function(){t=!0;F()}).css({fontSize:d,cursor:"pointer"});n=e("<span>").html("00").on("click",function(){t=!1;K()}).css({fontSize:d,
cursor:"pointer"});var c=e("<div>");c.append(q).append(e("<span>:</span>").css("fontSize",d)).append(n).append(s).css({position:"absolute",top:0,left:0,width:"100%",textAlign:"center",background:a.h,color:a.f});var p=e("<div>Done</div>").css({width:"100%",cursor:"pointer",textAlign:"center",fontSize:2/3*d,position:"absolute",borderTop:"1px solid "+a.border,color:a.text,top:f+20+d,left:0}).on("click",J);C.append(D).append(B).append(y);k.append(C).append(c).append(p).append(m).append(v).append(b).append(l).append(w);
b=D[0].getContext("2d");b.arc(g,g,g,0,2*h);b.fillStyle=a.d;b.fill();F();O();C.on("mousemove mousedown mouseup touchstart touchend touchcancel click touchmove",function(a){if(!(!H||a.offsetX>f||a.offsetY>f)){var b;if("touchmove"==a.type||"touchstart"==a.type)a.offsetX=a.originalEvent.touches[0].pageX,a.offsetY=a.originalEvent.touches[0].pageY,b=C.offset(),a.offsetX-=b.left,a.offsetY-=b.top;switch(a.type){case "touchmove":b="mousemove";a.preventDefault();break;case "touchend":b="mouseup";break;
case "touchcancel":b="mouseup";break;case "touchstart":b="mousedown";break;default:b=a.type}"mousedown"==b&&(G=!0);"mouseup"==b&&(G=!1);if("click"==b||"mousedown"==b||"mousemove"==b&&G){a=P(a.offsetX,a.offsetY,t?12:60);if(null==a)return;var c=h/2,c=c+a*h/(t?6:30),c=c>2*h?c-2*h:c;A(c);if(t){k.attr("hour",a);var c=k.attr("minute")||0,c=parseInt(c),d=a}else k.attr("minute",a),d=k.attr("hour")||0,d=parseInt(d),c=a;c=Math.round(c);c=60==c?0:c;q.html((10>d&&0!=d?"&nbsp;":"")+(0==d?12:d));n.html((10>c?"0":
"")+c)}"mouseup"==b&&t&&(t=!1,K(),H=!1,setTimeout(function(){H=!0},100))}})})()})}})(jQuery);