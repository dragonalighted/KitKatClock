/*
=================================================
KitKatClock jQuery Plugin

Author: Bryan Iddings
http://iddings.co/KitKatClock

****MAINTAIN THIS HEADER WHEN REDISTRIBUTING****

This work is licensed under the Creative
Commons Attribution-NonCommercial-ShareAlike
4.0 International License. To view a copy of
this license, visit
http://creativecommons.org/licenses/by-nc-sa/4.0/
=================================================
*/
(function(d){window.__kkc=[];for(var A=["webkit","moz","ms","o"],n=!1,B=!1,t=document.createElement("canvas"),u=0;u<A.length;u++)if(void 0!==t.style["-"+A[u]+"-transform"]){n=!0;break}void 0!==t.style.transform&&(n=!0);t.getContext&&(B=!0);n?B?(__kkc.allow_draw=!0,__kkc.hour_mode=!0,__kkc.mouse_down=!1,__kkc.finalize=!1,__kkc.degrade=!0,__kkc.finalize_wrap=function(){!1!==__kkc.finalize&&__kkc.finalize()},__kkc.opener,__kkc.setup=function(a){function C(a){var c=a.colors;p.clearRect(0,0,a.size,a.size);
p.textBaseline="middle";p.fillStyle=c.numerals;p.font=a.fontSize+"px "+a.fontFamily;p.textAlign="center";for(var e=Math.PI/2,d=0;12>d;d++){var f=h+-1*Math.cos(e)*(h-a.fontSize/1.75),g=h+-1*Math.sin(e)*(h-a.fontSize/1.75);p.fillText(0==d?12:d,f,g);e+=Math.PI/6}l(parseInt(b.attr("hour"))*Math.PI/6,a);s.css("color",c.hand);x.css("color","")}function r(a){var c=a.colors;p.clearRect(0,0,a.size,a.size);p.textBaseline="middle";p.fillStyle=c.numerals;p.font=a.fontSize+"px "+a.fontFamily;p.textAlign="center";
for(var d=Math.PI/2,f=0;12>f;f++){var g=h+-1*Math.cos(d)*(h-a.fontSize/1.6),k=h+-1*Math.sin(d)*(h-a.fontSize/1.6);p.fillText(5*f,g,k);d+=Math.PI/6}l(parseInt(b.attr("minute"))*Math.PI/30,a);s.css("color","");x.css("color",c.hand)}function l(b,a){d("#kitkatclock .kkc-canvas-hand").css({"-webkit-transform":"rotate("+180*b/Math.PI+"deg)","-moz-transform":"rotate("+180*b/Math.PI+"deg)","-ms-transform":"rotate("+180*b/Math.PI+"deg)","-o-transform":"rotate("+180*b/Math.PI+"deg)",transform:"rotate("+180*
b/Math.PI+"deg)"})}__kkc.finalize=function(){if(null!==__kkc.opener){var a=s.html().replace("&nbsp;",""),c=x.html(),e=z.html();if("text"==__kkc.opener.type)__kkc.opener.value=a+":"+c+" "+e;else{var f=parseInt(12==a?0:a)+("AM"==e?0:12),f=(10>f?"0":"")+f+":"+c;console.log(f);__kkc.opener.value=f}f=parseInt(d(__kkc.opener).attr("kkc-id"));__kkc[f].time=a+":"+c+" "+e;b.hide()}};var c=a.colors,b=d("#kitkatclock");d("*",b).off();var f=d("#kitkatclock .kkc-time-cont"),s=d("#kitkatclock .kkc-hour"),x=d("#kitkatclock .kkc-minute"),
z=d("#kitkatclock .kkc-am-pm"),n=d("#kitkatclock .kkc-canvas-cont"),q=d("#kitkatclock .kkc-canvas-clock").attr({width:a.size,height:a.size}).css({position:"absolute",top:0,left:0,padding:"0px 10px"})[0].getContext("2d"),k=d("#kitkatclock .kkc-canvas-hand").attr({width:1.35*a.fontSize,height:a.size}).css({position:"absolute",top:0,left:"calc(50% - "+1.35*a.fontSize/2+"px)"})[0].getContext("2d"),p=d("#kitkatclock .kkc-canvas-numbers").attr({width:a.size,height:a.size}).css({position:"absolute",top:0,
left:0,padding:"0px 10px"})[0].getContext("2d"),v=d("#kitkatclock .kkc-am-btn"),w=d("#kitkatclock .kkc-pm-btn"),y=d("#kitkatclock .kkc-done-btn");f.css({height:a.fontSize,width:"100%",padding:"0px 0px 12px 0px",color:c.text,background:c.top_indicator_background});z.css({fontSize:a.fontSize/2});n.css({position:"relative",marginTop:4,height:a.size,cursor:"pointer"});var g=a.time.split(":"),f=parseInt(g[0]),m=parseInt(g[1].split(" ")[0]),g=-1!=g[1].toUpperCase().indexOf("AM");b.attr({hour:f,minute:m});
v.css({position:"absolute",bottom:0,left:10,width:a.fontSize,height:a.fontSize,fontSize:a.fontSize/2,lineHeight:a.fontSize+"px",textAlign:"center",border:"1px solid transparent",borderRadius:a.fontSize/2,cursor:"pointer"});w.css({position:"absolute",bottom:0,right:10,width:a.fontSize,height:a.fontSize,fontSize:a.fontSize/2,lineHeight:a.fontSize+"px",textAlign:"center",border:"1px solid transparent",borderRadius:a.fontSize/2,cursor:"pointer"});s.on("click",function(){C(a);__kkc.hour_mode=!0}).css({cursor:"pointer"});
x.on("click",function(){r(a);__kkc.hour_mode=!1}).css({cursor:"pointer"});g?(v.css("background",c.meridian_background_on),w.css("background",c.meridian_background_off)):(w.css("background",c.meridian_background_on),v.css("background",c.meridian_background_off));s.html(f);x.html((10>m?"0":"")+m);z.html(g?"AM":"PM");y.css({borderTop:"1px solid "+c.border,marginTop:"4px",cursor:"pointer"});var h=a.size/2;q.clearRect(0,0,a.size,a.size);q.fillStyle=c.clock;q.arc(h,h,h,0,2*Math.PI);q.fill();k.clearRect(0,
0,a.size,a.size);q=1.35*a.fontSize;m=q/2;g=h+-1*(h-a.fontSize/1.5);k.beginPath();k.moveTo(q/2,h);k.lineTo(m,g);k.strokeStyle=c.hand;k.lineWidth=8;k.stroke();k.closePath();k.arc(m,g,.675*a.fontSize,0,2*Math.PI);k.fillStyle=c.hand;k.fill();__kkc.allow_draw=!0;__kkc.hour_mode=!0;__kkc.mouse_down=!1;C(a);l(Math.PI/6*(12==f?0:f),a);v.on("click",function(){z.html("AM");v.css("background",c.meridian_background_on);w.css("background",c.meridian_background_off)});w.on("click",function(){z.html("PM");w.css("background",
c.meridian_background_on);v.css("background",c.meridian_background_off)});n.on("mousemove mousedown mouseup touchstart touchend touchcancel click touchmove",function(c){if(__kkc.allow_draw&&!d(c.target).is(v)&&!d(c.target).is(w)){var f;f=n.offset();var e=c.pageX,g=c.pageY;e||(e=c.originalEvent.touches[0].pageX,g=c.originalEvent.touches[0].pageY);e-=f.left;g-=f.top;switch(c.type){case "touchmove":f="mousemove";c.preventDefault();break;case "touchend":f="mouseup";break;case "touchcancel":f="mouseup";
break;case "touchstart":f="mousedown";break;default:f=c.type}"mousedown"==f&&(__kkc.mouse_down=!0);"mouseup"==f&&(__kkc.mouse_down=!1);if("click"==f||"mousedown"==f||"mousemove"==f&&__kkc.mouse_down){c=__kkc.hour_mode?12:60;e-=h;g-=h;e/=-1*h;g/=-1*h;if(1<e||1<g||0==e&&0==g)return;e=Math.atan2(e,g);0<e&&(e=2*Math.PI-e);e=Math.abs(e);c=Math.PI/(c/2)*Math.round(e/(Math.PI/(c/2)))/(Math.PI/(c/2));e=0+c*Math.PI/(__kkc.hour_mode?6:30);e=e>2*Math.PI?e-2*Math.PI:e;l(e,a);__kkc.hour_mode?(b.attr("hour",c),
e=b.attr("minute")||0,e=parseInt(e),g=c):(b.attr("minute",c),g=b.attr("hour")||0,g=parseInt(g),e=c);e=Math.round(e);e=60==e?0:e;s.html((10>g&&0!=g?"&nbsp;":"")+(0==g?12:g));x.html((10>e?"0":"")+e)}"mouseup"==f&&__kkc.hour_mode&&(__kkc.hour_mode=!1,r(a),__kkc.allow_draw=!1,setTimeout(function(){__kkc.allow_draw=!0},100))}});y.on("click",__kkc.finalize);b.css({width:a.size+20,border:"3px solid "+c.border,fontSize:a.fontSize,textAlign:"center",color:c.text,background:c.background,fontFamily:a.fontFamily,
position:"absolute"});var g=d(__kkc.opener).offset(),k=d(document).width(),y=d(document).height(),f=b.outerWidth(),q=b.outerHeight(),m=g.top,g=g.left,t=d("body").scrollTop(),u=d("body").scrollLeft(),A=t+y,B=u+k;if(f<=k){for(;g<u;)g++;for(;g+f>B;)g--}else g=u-(f-k)/2;if(q<=y){for(;m<t;)m++;for(;m+q>A;)m--}else m=t-(q-y)/2;b.css({top:m,left:g}).show()},d.fn.kitkatclock=function(a){function n(c){if(null==c)return null;c=c.replace("#","").replace(/grey/i,"gray");if(-1!=c.indexOf("rgb")){if(-1!=c.indexOf("rgba"))return c;
rgb=c.split("(")[1].split(")")[0];return"rgba("+rgb+",1)"}if(l[c.toLowerCase()])return l[c.toLowerCase()];if(3==c.length){var b=c.substring(0,1),a=c.substring(1,2);c=c.substring(2,3);b+=b;a+=a;c+=c}else b=c.substring(0,2),a=c.substring(2,4),c=c.substring(4,6);return"rgba("+parseInt(b,16)+","+parseInt(a,16)+","+parseInt(c,16)+",1)"}function r(a,b,d){b=b.replace(/rgba|\(|\)/g,"");a=a.replace(/rgba|\(|\)/g,"");b=b.split(",");a=a.split(",");return"rgba("+Math.round((1-d)*parseInt(b[0])+parseInt(a[0])*
d)+","+Math.round((1-d)*parseInt(b[1])+parseInt(a[1])*d)+","+Math.round((1-d)*parseInt(b[2])+parseInt(a[2])*d)+",1)"}var l={aliceblue:"rgba(240,248,255,1)",antiquewhite:"rgba(250,235,215,1)",aqua:"rgba(0,255,255,1)",aquamarine:"rgba(127,255,212,1)",azure:"rgba(240,255,255,1)",beige:"rgba(245,245,220,1)",bisque:"rgba(255,228,196,1)",black:"rgba(0,0,0,1)",blanchedalmond:"rgba(255,235,205,1)",blue:"rgba(0,0,255,1)",blueviolet:"rgba(138,43,226,1)",brown:"rgba(165,42,42,1)",burlywood:"rgba(222,184,135,1)",
cadetblue:"rgba(95,158,160,1)",chartreuse:"rgba(127,255,0,1)",chocolate:"rgba(210,105,30,1)",coral:"rgba(255,127,80,1)",cornflowerblue:"rgba(100,149,237,1)",cornsilk:"rgba(255,248,220,1)",crimson:"rgba(220,20,60,1)",cyan:"rgba(0,255,255,1)",darkblue:"rgba(0,0,139,1)",darkcyan:"rgba(0,139,139,1)",darkgoldenrod:"rgba(184,134,11,1)",darkgray:"rgba(169,169,169,1)",darkgreen:"rgba(0,100,0,1)",darkkhaki:"rgba(189,183,107,1)",darkmagenta:"rgba(139,0,139,1)",darkolivegreen:"rgba(85,107,47,1)",darkorange:"rgba(255,140,0,1)",
darkorchid:"rgba(153,50,204,1)",darkred:"rgba(139,0,0,1)",darksalmon:"rgba(233,150,122,1)",darkseagreen:"rgba(143,188,143,1)",darkslateblue:"rgba(72,61,139,1)",darkslategray:"rgba(47,79,79,1)",darkturquoise:"rgba(0,206,209,1)",darkviolet:"rgba(148,0,211,1)",deeppink:"rgba(255,20,147,1)",deepskyblue:"rgba(0,191,255,1)",dimgray:"rgba(105,105,105,1)",dodgerblue:"rgba(30,144,255,1)",firebrick:"rgba(178,34,34,1)",floralwhite:"rgba(255,250,240,1)",forestgreen:"rgba(34,139,34,1)",fuchsia:"rgba(255,0,255,1)",
gainsboro:"rgba(220,220,220,1)",ghostwhite:"rgba(248,248,255,1)",gold:"rgba(255,215,0,1)",goldenrod:"rgba(218,165,32,1)",gray:"rgba(128,128,128,1)",green:"rgba(0,128,0,1)",greenyellow:"rgba(173,255,47,1)",honeydew:"rgba(240,255,240,1)",hotpink:"rgba(255,105,180,1)",indianred:"rgba(205,92,92,1)",indigo:"rgba(75,0,130,1)",ivory:"rgba(255,255,240,1)",khaki:"rgba(240,230,140,1)",lavender:"rgba(230,230,250,1)",lavenderblush:"rgba(255,240,245,1)",lawngreen:"rgba(124,252,0,1)",lemonchiffon:"rgba(255,250,205,1)",
lightblue:"rgba(173,216,230,1)",lightcoral:"rgba(240,128,128,1)",lightcyan:"rgba(224,255,255,1)",lightgoldenrodyellow:"rgba(250,250,210,1)",lightgray:"rgba(211,211,211,1)",lightgreen:"rgba(144,238,144,1)",lightpink:"rgba(255,182,193,1)",lightsalmon:"rgba(255,160,122,1)",lightseagreen:"rgba(32,178,170,1)",lightskyblue:"rgba(135,206,250,1)",lightslategray:"rgba(119,136,153,1)",lightsteelblue:"rgba(176,196,222,1)",lightyellow:"rgba(255,255,224,1)",lime:"rgba(0,255,0,1)",limegreen:"rgba(50,205,50,1)",
linen:"rgba(250,240,230,1)",magenta:"rgba(255,0,255,1)",maroon:"rgba(128,0,0,1)",mediumaquamarine:"rgba(102,205,170,1)",mediumblue:"rgba(0,0,205,1)",mediumorchid:"rgba(186,85,211,1)",mediumpurple:"rgba(147,112,219,1)",mediumseagreen:"rgba(60,179,113,1)",mediumslateblue:"rgba(123,104,238,1)",mediumspringgreen:"rgba(0,250,154,1)",mediumturquoise:"rgba(72,209,204,1)",mediumvioletred:"rgba(199,21,133,1)",midnightblue:"rgba(25,25,112,1)",mintcream:"rgba(245,255,250,1)",mistyrose:"rgba(255,228,225,1)",
moccasin:"rgba(255,228,181,1)",navajowhite:"rgba(255,222,173,1)",navy:"rgba(0,0,128,1)",oldlace:"rgba(253,245,230,1)",olive:"rgba(128,128,0,1)",olivedrab:"rgba(107,142,35,1)",orange:"rgba(255,165,0,1)",orangered:"rgba(255,69,0,1)",orchid:"rgba(218,112,214,1)",palegoldenrod:"rgba(238,232,170,1)",palegreen:"rgba(152,251,152,1)",paleturquoise:"rgba(175,238,238,1)",palevioletred:"rgba(219,112,147,1)",papayawhip:"rgba(255,239,213,1)",peachpuff:"rgba(255,218,185,1)",peru:"rgba(205,133,63,1)",pink:"rgba(255,192,203,1)",
plum:"rgba(221,160,221,1)",powderblue:"rgba(176,224,230,1)",purple:"rgba(128,0,128,1)",red:"rgba(255,0,0,1)",rosybrown:"rgba(188,143,143,1)",royalblue:"rgba(65,105,225,1)",saddlebrown:"rgba(139,69,19,1)",salmon:"rgba(250,128,114,1)",sandybrown:"rgba(244,164,96,1)",seagreen:"rgba(46,139,87,1)",seashell:"rgba(255,245,238,1)",sienna:"rgba(160,82,45,1)",silver:"rgba(192,192,192,1)",skyblue:"rgba(135,206,235,1)",slateblue:"rgba(106,90,205,1)",slategray:"rgba(112,128,144,1)",snow:"rgba(255,250,250,1)",
springgreen:"rgba(0,255,127,1)",steelblue:"rgba(70,130,180,1)",tan:"rgba(210,180,140,1)",teal:"rgba(0,128,128,1)",thistle:"rgba(216,191,216,1)",tomato:"rgba(255,99,71,1)",turquoise:"rgba(64,224,208,1)",violet:"rgba(238,130,238,1)",wheat:"rgba(245,222,179,1)",white:"rgba(255,255,255,1)",whitesmoke:"rgba(245,245,245,1)",yellow:"rgba(255,255,0,1)",yellowgreen:"rgba(154,205,50,1)"};return this.each(function(){a=a||{};a.time=a.time||"12:00 AM";var c=a.time.split(" ")[0],b=c.split(":")[0],b=parseInt(b);
12==b&&(b=0);c=c.split(":")[1];"am"!=a.time.split(" ")[1].toLowerCase()&&(b+=12);10>b&&(b="0"+b);this.value="time"==this.type?b+":"+c:a.time;b=a.size||350;"number"!==typeof b&&(b=b.indexOf("pt")?parseFloat(b)*(4/3):parseFloat(b));a.size=b-20;b=a.fontSize||40;"number"!==typeof b&&(b=b.indexOf("pt")?parseFloat(b)*(4/3):parseFloat(b));a.fontSize=b;a.fontFamily=a.fontFamily||"Verdana, sans-serif";b=a.colors||{};b.text=b.text||"#FFFFFF";b.clock=b.clock||"#050505";b.numerals=b.numerals||b.text;b.hand=b.hand||
"#960000";b.background=b.background||"#222222";b.meridian_background_on=b.meridian_background_on||b.hand;b.meridian_background_off=b.meridian_background_off||null;b.meridian_text=b.meridian_text||b.text;b.top_indicator_selected=b.top_indicator_selected||b.hand;b.top_indicator_deselected=b.top_indicator_deselected||b.text;b.top_indicator_background=b.top_indicator_background||b.clock;b.border=b.border||"#CCCCCC";for(var f in b)b[f]=n(b[f]);b.meridian_background_off||(b.meridian_background_off=r(b.meridian_background_on,
b.background,.6));a.colors=b;__kkc.push(a);d(this).attr("kkc-id",__kkc.length-1).on("mouseup",function(){d(this).is(":focus")&&(this.blur(),__kkc.finalize_wrap(),__kkc.opener=this,__kkc.setup(__kkc[parseInt(d(this).attr("kkc-id"))]))})})},d.fn.kitkatclock.noDegrade=function(a){!0!==a?__kkc.degrade=!1:__kkc.degrade&&d("input[data-role='time'], input[type='time']").kitkatclock()},d(function(){var a=d("<div id='kitkatclock'>").hide(),n=d("<div class='kkc-time-cont'>"),r=d("<span class='kkc-hour'>"),
l=d("<span class='kkc-minute'>"),c=d("<span class='kkc-am-pm'>");n.append(r).append(":").append(l).append(c);var r=d("<div class='kkc-canvas-cont'>"),l=d("<canvas class='kkc-canvas-clock'>"),c=d("<canvas class='kkc-canvas-hand'>"),b=d("<canvas class='kkc-canvas-numbers'>"),f=d("<div class='kkc-am-btn'>AM</div>"),s=d("<div class='kkc-pm-btn'>PM</div>");r.append(l).append(c).append(b).append(f).append(s);l=d("<div class='kkc-done-btn'>Done</div>");a.append(n).append(r).append(l);d("body").append(a).on("click",
function(a){var b=d(a.target).attr("kkc-id");0!=d("#kitkatclock").has(a.target).length||"undefined"!==typeof b&&!1!==b||__kkc.finalize_wrap()});d().kitkatclock.noDegrade(!0)})):(console.log("KitKatClock disabled, no canvas support"),__kkc="KitKatClock Disabled",d.fn.kitkatclock=function(){return this}):(console.log("KitKatClock disabled, no CSS3 support"),__kkc="KitKatClock Disabled",d.fn.kitkatclock=function(){return this})})(jQuery);