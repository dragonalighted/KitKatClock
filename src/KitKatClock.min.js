/*
=================================================
KitKatClock jQuery Plugin

Author: Bryan Iddings
http://iddings.co/KitKatClock

****MAINTAIN THIS HEADER WHEN REDISTRIBUTING****

This work is licensed under the Creative
Commons Attribution-NonCommercial-ShareAlike
4.0 International License. To view a copy of
this license, visit
http://creativecommons.org/licenses/by-nc-sa/4.0/
=================================================
*/
(function(a){function e(d,b){!0===b&&(b="true");!1===b&&(b="false");var e=null===b||void 0===b?a(".kitkat-clock").attr("data-"+d):a(".kitkat-clock").attr("data-"+d,b);if("true"==e||"false"==e)e="true"==e;return e}function l(d,b){if(null===b||void 0===b)b=300;if("minute"==d){a(".kitkat-clock-minutes").show();a(".kitkat-clock-hours").animate({top:"-10%",left:"-10%",width:"120%",height:"120%",opacity:0},b,"flex",function(){a(".kitkat-clock-hours").hide()});a(".kitkat-clock-minutes").css({top:"10%",left:"10%",
width:"80%",height:"80%",opacity:0});a(".kitkat-clock-minutes").animate({top:"0%",left:"0%",width:"100%",height:"100%",opacity:1},b,"flex");a(".kitkat-clock-minutes").show();e("hourmode",!1);a(".kitkat-hour").removeClass("kitkat-time-active");a(".kitkat-minute").addClass("kitkat-time-active");var h=parseInt(e("minutes"));isNaN(h)&&(h=0);setTimeout(function(){a(".kitkat-clock-hand").css({"-webkit-transform":"rotate("+6*h+"deg)"})},b/2)}else a(".kitkat-clock-hours").show(),a(".kitkat-clock-minutes").animate({top:"10%",
left:"10%",width:"80%",height:"80%",opacity:0},b,"flex",function(){a(".kitkat-clock-minutes").hide()}),a(".kitkat-clock-hours").css({top:"-10%",left:"-10%",width:"120%",height:"120%",opacity:0}),a(".kitkat-clock-hours").animate({top:"0%",left:"0%",width:"100%",height:"100%",opacity:1},b,"flex"),e("hourmode",!0),a(".kitkat-hour").addClass("kitkat-time-active"),a(".kitkat-minute").removeClass("kitkat-time-active"),h=parseInt(e("hours")),isNaN(h)&&(h=0),setTimeout(function(){a(".kitkat-clock-hand").css({"-webkit-transform":"rotate("+
30*h+"deg)"})},b/2)}a(function(){var d=a("<div class='kitkat-clock-element kitkat-container'>\t\t\t\t\t\t<div class='kitkat-clock-element kitkat-time'>\t\t\t\t\t\t\t<span class='kitkat-clock-element kitkat-hour'>12</span>\t\t\t\t\t\t\t:\t\t\t\t\t\t\t<span class='kitkat-clock-element kitkat-minute'>00</span>\t\t\t\t\t\t\t<span class='kitkat-clock-element kitkat-am-pm'>AM</span>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class='kitkat-clock-element kitkat-clock'>\t\t\t\t\t\t\t<div class='kitkat-clock-element kitkat-clock-body'>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<div class='kitkat-clock-element kitkat-clock-hand'>\t\t\t\t\t\t\t\t<div class='kitkat-clock-element kitkat-clock-hand-line'></div>\t\t\t\t\t\t\t\t<div class='kitkat-clock-element kitkat-clock-hand-end'></div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<div class='kitkat-clock-element kitkat-clock-hours'>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<div class='kitkat-clock-element kitkat-clock-minutes'>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<div class='kitkat-clock-element kitkat-clock-cover'>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<div class='kitkat-clock-element kitkat-clock-am kitkat-clock-am-pm-active'><span>AM</span></div>\t\t\t\t\t\t\t<div class='kitkat-clock-element kitkat-clock-pm'><span>PM</span></div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class='kitkat-clock-element kitkat-done'>\t\t\t\t\t\t\tDone\t\t\t\t\t\t</div>\t\t\t\t\t</div>");
a("body").append(d).on("click",function(c){a(c.target).hasClass("kitkat-clock-element")||"time"==a(c.target).attr("data-role")||(c=parseInt(e("minutes")),10>c&&(c="0"+c),a("input[data-kitkat-active=true]").val(e("hours")+":"+c+(e("is_am")?" AM":" PM")).attr("data-kitkat-active","false"),a(".kitkat-container").hide())});for(d=0;12>d;d++){var b=Math.PI/2+d*Math.PI/6,h=.5-.78*Math.cos(b)/2,b=.5-.78*Math.sin(b)/2,h=a("<div>").html(0!=d?d:12).css({position:"absolute",top:100*b+"%",left:100*h+"%"});a(".kitkat-clock-hours").append(h)}for(d=
0;12>d;d++)b=Math.PI/2+d*Math.PI/6,h=.5-.78*Math.cos(b)/2,b=.5-.78*Math.sin(b)/2,h=a("<div>").html(5*d).css({position:"absolute",top:100*b+"%",left:100*h+"%"}),a(".kitkat-clock-minutes").append(h);e("hourmode",!0);e("mousedown",!1);a(".kitkat-hour").addClass("kitkat-time-active").on("click",function(){e("hourmode")||l("hour")});a(".kitkat-minute").on("click",function(){e("hourmode")&&l("minute")});a(".kitkat-clock-hours").children().each(function(){a(this).css({marginTop:a(this).outerHeight()/-2,
marginLeft:a(this).outerWidth()/-2})});a(".kitkat-clock-minutes").children().each(function(){a(this).css({marginTop:a(this).outerHeight()/-2,marginLeft:a(this).outerWidth()/-2})});a(".kitkat-clock-am").on("click",function(){e("is_am",!0);a(".kitkat-clock-am").addClass("kitkat-clock-am-pm-active");a(".kitkat-clock-pm").removeClass("kitkat-clock-am-pm-active");a(".kitkat-am-pm").html("AM")});a(".kitkat-am-pm").on("click",function(){e("is_am")?(a(".kitkat-clock-am").removeClass("kitkat-clock-am-pm-active"),
a(".kitkat-clock-pm").addClass("kitkat-clock-am-pm-active"),a(".kitkat-am-pm").html("PM")):(a(".kitkat-clock-pm").removeClass("kitkat-clock-am-pm-active"),a(".kitkat-clock-am").addClass("kitkat-clock-am-pm-active"),a(".kitkat-am-pm").html("AM"));e("is_am",!e("is_am"))});a(".kitkat-clock-pm").on("click",function(){e("is_am",!1);a(".kitkat-clock-pm").addClass("kitkat-clock-am-pm-active");a(".kitkat-clock-am").removeClass("kitkat-clock-am-pm-active");a(".kitkat-am-pm").html("PM")});a(".kitkat-clock-minutes").hide();
a(".kitkat-done").on("click",function(){var c=parseInt(e("minutes"));10>c&&(c="0"+c);a("input[data-kitkat-active=true]").val(e("hours")+":"+c+(e("is_am")?" AM":" PM")).attr("data-kitkat-active","false");a(".kitkat-container").hide()});a(".kitkat-clock-cover").on("mousemove mousedown mouseup touchstart touchend touchcancel click touchmove",function(c){var b;if("touchmove"==c.type||"touchstart"==c.type)c.offsetX=c.originalEvent.touches[0].pageX,c.offsetY=c.originalEvent.touches[0].pageY,b=a(".kitkat-clock-body").offset(),
c.offsetX-=b.left,c.offsetY-=b.top;switch(c.type){case "touchmove":b="mousemove";c.preventDefault();break;case "touchend":b="mouseup";break;case "touchcancel":b="mouseup";break;case "touchstart":b="mousedown";break;default:b=c.type}var d=a(".kitkat-clock-body").outerWidth()/2;"mousedown"==b&&e("mousedown",!0);"mouseup"==b&&e("mousedown",!1);if("click"==b||"mousedown"==b||"mousemove"==b&&e("mousedown")){var g=e("hourmode")?12:60,f=c.offsetX-d;c=c.offsetY-d;g/=2;d=Math.sqrt(f*f+c*c);c=Math.asin(c/d);
c=Math.PI/g*Math.round(c/(Math.PI/g));c/=Math.PI;c*=g;g/=2;0<f||(g*=3,c*=-1);f=g+c;g=0+f*Math.PI/(e("hourmode")?6:30);g=g>2*Math.PI?g-2*Math.PI:g;a(".kitkat-clock-hand").css({"-webkit-transform":"rotate("+180/Math.PI*g+"deg)"});f=Math.round(f);e("hourmode")?(0==f&&(f=12),e("hours",f),a(".kitkat-hour").html(f),"mouseup"!=b&&"click"!=b||l("minute")):(60==f&&(f=0),e("minutes",f),10>f&&(f="0"+f),a(".kitkat-minute").html(f))}});a(".kitkat-container").hide();a.fn.kitkatclock.noDegrade(!0)});a.easing.flex=
function(a){return.5>a?-.125*Math.sin(a*Math.PI*2):2*a-1};a.fn.kitkatclock=function(){return this.each(function(){a(this).on("click",function(){var d="12:00 AM";this.value.match(/\d{1,2}\:\d{2} AM|PM/i)&&(d=this.value);d=d.split(":");e("hours",d[0]);e("is_am",-1!=d[1].toLowerCase().indexOf("am"));e("minutes",d[1].split(" ")[0]);a(".kitkat-hour").html(d[0]);a(".kitkat-minute").html(d[1].split(" ")[0]);a(".kitkat-am-pm").html(d[1].split(" ")[1].toUpperCase());a("input[data-kitkat-active=true]").attr("data-kitkat-active",
"false");a(this).attr("data-kitkat-active","true");a(".kitkat-clock-am, .kitkat-clock-pm").removeClass("kitkat-clock-am-pm-active");a(".kitkat-clock-"+(e("is_am")?"am":"pm")).addClass("kitkat-clock-am-pm-active");l("hour",0);for(var d=a(".kitkat-container"),b=a(this).offset(),h=a(window).width(),c=a(window).height(),p=a(document).width(),q=a(document).height(),g=d.outerWidth(),f=d.outerHeight(),k=b.top,b=b.left,m=a("body").scrollTop(),n=a("body").scrollLeft(),r=m+c,s=n+h;k+f>q&&0<k;)k-=1;for(;b+g>
p&&0<b;)b-=1;if(g<=h){for(;b<n;)b++;for(;b+g>s;)b--}else b=n-(g-h)/2;if(f<=c){for(;k<m;)k++;for(;k+f>r;)k--}else k=m-(f-c)/2;d.css({position:"absolute",top:k,left:b}).show()})})};a.fn.kitkatclock.noDegrade=function(d){d?(a("input[type=time]").attr({type:"text","data-role":"time"}),a("input[data-role=time]").kitkatclock()):a.fn.kitkatclock=function(){}}})(jQuery);